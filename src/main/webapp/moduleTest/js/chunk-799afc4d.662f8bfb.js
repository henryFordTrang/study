(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-799afc4d"],{2532:function(e,t,s){"use strict";var i=s("23e7"),n=s("5a34"),a=s("1d80"),o=s("ab13");i({target:"String",proto:!0,forced:!o("includes")},{includes:function(e){return!!~String(a(this)).indexOf(n(e),arguments.length>1?arguments[1]:void 0)}})},"4c11":function(e,t,s){"use strict";s.r(t);var i=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"wrapper"},[i("div",{staticClass:"board"},[i("ul",{staticClass:"board__ul"},e._l(e.receiveInfo,(function(t,n){return i("li",{key:n,class:t.id!=e.user?"board__li":"board__limi"},[i("img",{directives:[{name:"show",rawName:"v-show",value:t.id!=e.user,expression:"item.id != user"}],staticClass:"board__li__icon",attrs:{src:s("c121"),alt:""}}),0==t.pic?i("div",{class:t.id!=e.user?"board__li__message":"board__limi__messagemi"},[e._v(" "+e._s(t.message)+" ")]):e._e(),1==t.pic?i("img",{class:t.id!=e.user?"board__li__messageImg":"board__limi__messagemiImg",attrs:{src:t.message,alt:""}}):e._e(),2==t.pic?i("video",{class:t.id!=e.user?"board__li__messageImg":"board__limi__messagemiImg",attrs:{autoplay:"",src:t.message}}):e._e(),i("img",{directives:[{name:"show",rawName:"v-show",value:t.id==e.user,expression:"item.id == user"}],staticClass:"board__limi__iconmi",attrs:{src:s("c121"),alt:""}})])})),0)]),i("van-field",{staticClass:"chart__border",attrs:{placeholder:"请输入用户名"},model:{value:e.chat,callback:function(t){e.chat=t},expression:"chat"}},[i("van-button",{directives:[{name:"show",rawName:"v-show",value:e.chat.length>0,expression:"chat.length > 0"}],attrs:{slot:"button",type:"primary",size:"small"},on:{click:e.publish},slot:"button"},[e._v("publish")]),i("van-uploader",{directives:[{name:"show",rawName:"v-show",value:0==e.chat.length,expression:"chat.length == 0"}],attrs:{slot:"button","after-read":e.afterRead,"preview-image":!1},slot:"button",model:{value:e.fileList,callback:function(t){e.fileList=t},expression:"fileList"}},[i("van-icon",{attrs:{name:"add-o",size:"27px"}})],1)],1)],1)},n=[],a=(s("caad"),s("b0c0"),s("2532"),s("2f62")),o={computed:Object(a["b"])({location:"generator/location"}),data:function(){return{address:"",client:"",chat:"",user:"",receiveInfo:[],usersList:[],fileList:[],ifpic:!1}},methods:{websocketCheck:function(){var e=this;"WebSocket"in window?(console.log("您的浏览器支持 WebSocket!"),e.client&&e.client.close(),e.user=1e4*Math.random(),e.user=Math.round(e.user),e.client=new WebSocket("ws://"+window.location.host+"/study/websocket/czd/"+e.user),e.client.onopen=function(){console.log("websocket连接上了...")},e.client.onmessage=function(t){var s=JSON.parse(t.data),i=Object.assign({message:s.message,id:s.id,pic:s.isPic});e.receiveInfo.push(i)},e.client.onclose=function(){console.log("连接已关闭...")}):alert("您的浏览器不支持 WebSocket!")},reconnect:function(){var e=this;"WebSocket"in window?(console.log("您的浏览器支持 WebSocket!"),e.user=1e4*Math.random(),e.user=Math.round(e.user),e.client=new WebSocket("ws://"+window.location.host+"/study/websocket/czd/"+e.user),e.client.onopen=function(){console.log("连接websocket...")},e.client.onmessage=function(t){var s=JSON.parse(t.data),i=Object.assign({message:s.message,id:s.id});e.receiveInfo.push(i)},e.client.onclose=function(){console.log("连接已关闭...")}):alert("您的浏览器不支持 WebSocket!")},publish:function(){var e=this;console.log("数据发送中..."),e.ifpic=!1;var t=Object.assign({message:e.chat,ifpic:0});e.client.send(JSON.stringify(t)),e.chat=""},afterRead:function(e){var t=this;console.log(e,e.file.type);var s=e.file.type.includes("image");console.log(s);var i="/study/ftp/upload",n=Object.assign({strbase64:e.content,filename:e.file.name});request.post(i,n).then((function(e){var i=Object.assign({message:e,ifpic:s?1:2});t.client.send(JSON.stringify(i))}))},closeWs:function(){var e=this;e.client.close()},onClickLeft:function(){var e=this;e.client.close(),window.$utils.exit()},onClickRight:function(){var e=this;e.client.close(),e.$toast(99)}},mounted:function(){var e=this;e.websocketCheck(),document.addEventListener("keyup",(function(t){"Enter"==t.key&&e.publish()}))}},c=o,r=(s("fab0"),s("2877")),l=Object(r["a"])(c,i,n,!1,null,"75a81ee6",null);t["default"]=l.exports},"5a34":function(e,t,s){var i=s("44e7");e.exports=function(e){if(i(e))throw TypeError("The method doesn't accept regular expressions");return e}},7617:function(e,t,s){},ab13:function(e,t,s){var i=s("b622"),n=i("match");e.exports=function(e){var t=/./;try{"/./"[e](t)}catch(s){try{return t[n]=!1,"/./"[e](t)}catch(i){}}return!1}},c121:function(e,t,s){e.exports=s.p+"img/user.91d28fda.png"},caad:function(e,t,s){"use strict";var i=s("23e7"),n=s("4d64").includes,a=s("44d2"),o=s("ae40"),c=o("indexOf",{ACCESSORS:!0,1:0});i({target:"Array",proto:!0,forced:!c},{includes:function(e){return n(this,e,arguments.length>1?arguments[1]:void 0)}}),a("includes")},fab0:function(e,t,s){"use strict";var i=s("7617"),n=s.n(i);n.a}}]);